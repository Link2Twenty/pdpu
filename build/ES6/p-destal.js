import{PDX}from"./p-d-x.js";export class PDestal extends PDX{constructor(){super(...arguments);this._previousValues={}}static get is(){return"p-destal"}getPreviousSib(){let parent=this;while(parent=parent.parentNode){if(11===parent.nodeType){return parent.host}else if(-1<parent.tagName.indexOf("-")){return parent}else if("HTML"===parent.tagName){this.watchLocation();return null}}this._useLocation}doFakeEvent(){const split=this._on.split(","),searchParams=new URLSearchParams(location.search);let changedVal=!1;split.forEach(param=>{const trimmedParam=param.substr(1,param.length-2),searchParm=searchParams.get(trimmedParam);if(!changedVal&&searchParm!==this._previousValues[trimmedParam]){changedVal=!0}this._previousValues[trimmedParam]=searchParm});if(changedVal){const fakeEvent={target:this._previousValues};this._handleEvent(fakeEvent)}}watchLocation(){window.addEventListener("popstate",()=>{this.doFakeEvent()});this.doFakeEvent()}}if(!customElements.get(PDestal.is))customElements.define(PDestal.is,PDestal);